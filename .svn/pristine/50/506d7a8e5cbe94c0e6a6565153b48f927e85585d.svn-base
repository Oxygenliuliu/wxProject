(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/uni-order/uniOrder"],{"030a":function(t,e,a){"use strict";a.r(e);var n=a("7576"),r=a.n(n);for(var i in n)"default"!==i&&function(t){a.d(e,t,(function(){return n[t]}))}(i);e["default"]=r.a},"0e54":function(t,e,a){"use strict";var n=a("a538"),r=a.n(n);r.a},7576:function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=r(a("4795"));r(a("ea90"));function r(t){return t&&t.__esModule?t:{default:t}}function i(t,e,a,n,r,i,s){try{var o=t[i](s),c=o.value}catch(u){return void a(u)}o.done?e(c):Promise.resolve(c).then(n,r)}function s(t){return function(){var e=this,a=arguments;return new Promise((function(n,r){var s=t.apply(e,a);function o(t){i(s,n,r,o,c,"next",t)}function c(t){i(s,n,r,o,c,"throw",t)}o(void 0)}))}}var o={components:{},props:{scrollHeight:{type:[Number,String],default:function(){return 0}},orderQuerry:{type:Object,default:function(){return{key:!1}}},maskTop:{type:String,default:function(){return""}},fparams:{type:Object,default:function(){return{}}},dbname:{type:String,default:function(){return""}}},data:function(){return{tabBars:[{id:0,name:"全部",isTrue:!0},{id:1,name:"已结清",isTrue:!1},{id:2,name:"未结清",isTrue:!1}],dailyList:[],tabIndex:0,orderList:{allData:[],clear:[],notClear:[]},newsList:[],pageLarge:{nowIndexA:0,nowIndexB:0,nowIndexC:0},pageMaxSize:{pageA:-1,pageB:-1,pageC:-1},nowInfo:{nowIndex:0,maxSize:-1},allCheck:!1,orderNums:0,zMask:!1,prepay_id:"",pageSettlement:0,chooseAll:!1,chooseAllIsShow:!1}},methods:{choose:function(){var t=this;this.chooseAll=!this.chooseAll,this.dailyList.forEach((function(e){e.isTrue=t.chooseAll}))},displayMore:function(t){var e=this;this.dailyList.some((function(a,n){if(a.BILL_ID==t)return a.isShow=!a.isShow,e.$set(e.dailyList,n,a),!0}))},refresh:function(){var e=this;return s(n.default.mark((function a(){var r;return n.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(!(e.nowInfo.maxSize>=e.nowInfo.nowIndex||-1==e.nowInfo.maxSize)){a.next=8;break}return e.addPageInfo(),a.next=4,e.wrquest(e.params);case 4:r=a.sent,e.setDisplayData(r),a.next=10;break;case 8:return t.showToast({title:"到底了",icon:"none"}),a.abrupt("return");case 10:case"end":return a.stop()}}),a)})))()},changeCheckStatu:function(t){this.dailyList=this.dailyList.map((function(e){return e.BILL_CODE==t&&(e.isTrue=!e.isTrue),e}))},setDisplayData:function(t){var e=this.contactDoubleArr(t);switch(this.dailyList=e,this.tabIndex){case 0:this.orderList.allData=e;break;case 1:this.orderList.clear=e;break;case 2:this.orderList.notClear=e;break;default:break}},addPageInfo:function(){switch(this.tabIndex){case 0:this.nowInfo.nowIndex=this.pageLarge.nowIndexA=this.pageLarge.nowIndexA+1,this.nowInfo.maxSize=this.pageMaxSize.pageA;break;case 1:this.nowInfo.nowIndex=this.pageLarge.nowIndexB=this.pageLarge.nowIndexB+1,this.nowInfo.maxSize=this.pageMaxSize.pageB;break;case 2:this.nowInfo.nowIndex=this.pageLarge.nowIndexC=this.pageLarge.nowIndexC+1,this.nowInfo.maxSize=this.pageMaxSize.pageC;break;default:break}},setPageInfo:function(){switch(this.tabIndex){case 0:this.nowInfo.nowIndex=this.pageLarge.nowIndexA,this.nowInfo.maxSize=this.pageMaxSize.pageA;break;case 1:this.nowInfo.nowIndex=this.pageLarge.nowIndexB,this.nowInfo.maxSize=this.pageMaxSize.pageB;break;case 2:this.nowInfo.nowIndex=this.pageLarge.nowIndexC,this.nowInfo.maxSize=this.pageMaxSize.pageC;break;default:break}},setMaxPage:function(t){switch(this.tabIndex){case 0:this.nowInfo.maxSize=this.pageMaxSize.pageA=parseInt(t/8);break;case 1:this.nowInfo.maxSize=this.pageMaxSize.pageB=parseInt(t/8);break;case 2:this.nowInfo.maxSize=this.pageMaxSize.pageC=parseInt(t/8);break;default:break}},someInit:function(){for(var t in this.pageLarge={nowIndexA:0,nowIndexB:0,nowIndexC:0},this.pageMaxSize={pageA:-1,pageB:-1,pageC:-1},this.nowInfo={nowIndex:0,maxSize:0},0==this.pageSettlement&&(this.params.MODE="2"),this.params)this.params[t]=this.fparams[t];this.changeType(0),this.tabIndex=0,this.dailyList=[],this.orderList.allData=this.orderList.clear=this.orderList.notClear=[]},changeType:function(t){2==this.tabIndex?this.$emit("changeScrollHeight",{type:!0,height:70}):(this.$emit("changeScrollHeight",{type:!1,height:70}),this.chooseAll=!1),this.tabBars.forEach((function(e){e.isTrue=!1,e.id==t&&(e.isTrue=!0)}))},ontabtap:function(t){var e=parseInt(t.target.dataset.current||t.currentTarget.dataset.current);this.tabIndex=e},ontabchange:function(t){var e=parseInt(t.target.current||t.detail.current);this.tabIndex=e,this.params.MODE=e,this.setPageInfo(),this.changeType(e),this.setOrderList(e,this.params)},changeScreen:function(t){var e=t.data1,a=t.data2;this.someInit(),0!=e.length&&this.packageData1(e),0!=a.length&&this.packageData2(a),this.queryData()},packageData1:function(t){var e=this;t.forEach((function(t){if(102==t.id){e.params.BEGINDATE=t.times.statrTime;var a=t.times.endTime,n=[];n=a.split("-"),n[2]=parseInt(n[2])+1,e.params.ENDDATE=n.join("-")}}))},wrquest:function(){var e=this;arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.params;return this.params.PAGE_INDEX=this.nowInfo.nowIndex,t.showLoading({title:"加载中..."}),new Promise((function(a,n){t.request({url:"https://cloud.fydlsoft.com/transit_server",method:"POST",data:{interface_add:"http://122.114.123.189:7798/public/query",dbname:e.dbname,params:JSON.stringify(e.params)},success:function(r){0==r.data.status?(e.setMaxPage(r.data.total),a(r.data.data)):n(t.showToast({title:"异常",icon:"none"}))},fail:function(e){t.showToast({title:"网络异常",icon:"none"})},complete:function(e){t.hideLoading()}})}))},queryData:function(){var t=arguments,e=this;return s(n.default.mark((function a(){var r,i;return n.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=t.length>0&&void 0!==t[0]?t[0]:e.params,a.next=3,e.wrquest(r);case 3:i=a.sent,e.dailyList=e.createDoubleArr(i),e.orderList.allData=e.dailyList,e.appendCheckBox();case 7:case"end":return a.stop()}}),a)})))()},contactDoubleArr:function(t){var e=this.createDoubleArr(t);e.forEach((function(t){t.child.length}));var a=this.dailyList;return a.forEach((function(t){t.child.length})),e.forEach((function(t,e){var n=a.some((function(e,a){if(t.BILL_ID==e.BILL_ID)return e.child=e.child.concat(t.child),!0}));n||a.push(t)})),a.forEach((function(t){t.child.length})),a},createDoubleArr:function(t){var e=[];return t.filter((function(t){var a={};a["BILL_CODE"]=t.BILL_CODE,a["BILL_DATE_STR"]=t.BILL_DATE_STR,a["BILL_ID"]=t.BILL_ID,a["BILL_LEFTMONEY"]=t.BILL_LEFTMONEY,a["child"]=[],e.push(a)})),e=e.filter((function(t,e,a){return a.findIndex((function(e){return e.BILL_CODE==t.BILL_CODE}))===e})),e.forEach((function(e,a){t.forEach((function(t,a){var n=!1,r={};e.BILL_ID==t.BILL_ID&&(n=!0,r["BILLDETAIL_GOODSNAME"]=t.BILLDETAIL_GOODSNAME,r["BILLDETAIL_TOTALMONEY"]=t.BILLDETAIL_TOTALMONEY,r["BILLDETAIL_W"]=t.BILLDETAIL_W,r["BILLDETAIL_PRICE"]=t.BILLDETAIL_PRICE,r["BILLDETAIL_H"]=t.BILLDETAIL_H,r["BILLDETAIL_TOTALQTY"]=t.BILLDETAIL_TOTALQTY),n&&e.child.push(r)}))})),e},returnAppendCheckBox:function(t){return t.forEach((function(t,e){t.isTrue=!1,t.isShow=!1})),t},appendCheckBox:function(){var t=this;0!=this.dailyList.length&&this.dailyList.forEach((function(e,a){t.$set(t.dailyList[a],"isTrue",!1),t.$set(t.dailyList[a],"isShow",!1)}))},pullRefresh:function(){this.params.PAGE_INDEX=0,this.queryData()},jqueyForCustomer:function(t){var e=this;this.pageSettlement=t.type,0==t.type?([1].forEach((function(){e.newsList.push(t)})),this.chooseAllIsShow=!1):([1,2,3].forEach((function(){e.newsList.push(t)})),this.chooseAllIsShow=!0),this.queryData()},pay:function(){var e=this;return s(n.default.mark((function a(){var r,i;return n.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,e.beforeWXpay("https://proxy.fydlsoft.com").catch((function(){return{state:500}}));case 2:if(r=a.sent,200!=r.statusCode){a.next=7;break}e.WXpay(r.data),a.next=16;break;case 7:if(404!=r.statusCode){a.next=15;break}return t.showToast({title:"启用备用域名",icon:"none"}),a.next=11,e.beforeWXpay("https://cloud1.fydlsoft.com").catch((function(){return{state:500}}));case 11:i=a.sent,200==i.statusCode?e.WXpay(i.data):t.showToast({title:"网络异常请稍后重试",icon:"none"}),a.next=16;break;case 15:t.showToast({title:"网络异常请稍后重试",icon:"none"});case 16:case"end":return a.stop()}}),a)})))()},beforeWXpay:function(e){return t.showLoading({title:"发起支付中..."}),new Promise((function(a,n){wx.login({success:function(r){var i=r.code;t.request({url:e+"/unifiedorder",method:"POST",data:{total_fee:"0.01",code:i},success:function(t){a(t)},fail:function(e){t.showToast({title:"请求失败错误码201",icon:"none"}),n()}})}})}))},WXpay:function(e){t.requestPayment({provider:"wxpay",timeStamp:e.timeStamp,nonceStr:e.nonceStr,package:e.package,signType:e.signType,paySign:e.paySign,success:function(e){t.showLoading({title:"支付结果查询中..."}),"requestPayment:ok"==e.errMsg&&t.showToast({title:"支付成功",icon:"success"})},fail:function(e){t.showToast({title:"支付已取消",icon:"none"})},complete:function(){t.hideLoading()}})},setOrderList:function(){var t=arguments,e=this;return s(n.default.mark((function a(){var r,i,s,o,c,u;return n.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:r=t.length>0&&void 0!==t[0]?t[0]:-1,i=t.length>1?t[1]:void 0,a.t0=r,a.next=-1===a.t0?5:0===a.t0?11:1===a.t0?21:2===a.t0?31:41;break;case 5:return a.next=7,e.wrquest(i);case 7:return s=a.sent,e.orderList.allData=e.createDoubleArr(s),e.dailyList=e.orderList.allData,a.abrupt("break",42);case 11:if(0!=e.orderList.allData.length){a.next=19;break}return a.next=14,e.wrquest(i);case 14:o=a.sent,e.orderList.allData=e.createDoubleArr(o),e.dailyList=e.orderList.allData,a.next=20;break;case 19:e.dailyList=e.orderList.allData;case 20:return a.abrupt("break",42);case 21:if(0!=e.orderList.clear.length){a.next=29;break}return a.next=24,e.wrquest(i);case 24:c=a.sent,e.orderList.clear=e.createDoubleArr(c),e.dailyList=e.orderList.clear,a.next=30;break;case 29:e.dailyList=e.orderList.clear;case 30:return a.abrupt("break",42);case 31:if(0!=e.orderList.notClear.length){a.next=39;break}return a.next=34,e.wrquest(i);case 34:u=a.sent,e.orderList.notClear=e.createDoubleArr(u),e.dailyList=e.orderList.notClear,a.next=40;break;case 39:e.dailyList=e.orderList.notClear;case 40:return a.abrupt("break",42);case 41:return a.abrupt("break",42);case 42:e.appendCheckBox();case 43:case"end":return a.stop()}}),a)})))()}},created:function(){},computed:{params:{set:function(){return{}},get:function(){var t=this.wpublic.deepClone(this.fparams);return t}},num:{set:function(){return 0},get:function(){if(0==this.pageSettlement)return this.dailyList.length;var t=0;return this.dailyList.forEach((function(e){e.isTrue&&t++})),t}},sales:{set:function(){return 0},get:function(){var t=this,e=0;return this.dailyList.forEach((function(a){0==t.pageSettlement?e+=Math.abs(parseFloat(a.BILL_LEFTMONEY)):a.isTrue&&(e+=Math.abs(parseFloat(a.BILL_LEFTMONEY)))})),e}}}};e.default=o}).call(this,a("543d")["default"])},a06c:function(t,e,a){"use strict";a.r(e);var n=a("f535"),r=a("030a");for(var i in r)"default"!==i&&function(t){a.d(e,t,(function(){return r[t]}))}(i);a("0e54");var s,o=a("f0c5"),c=Object(o["a"])(r["default"],n["b"],n["c"],!1,null,"d5f1f0c2",null,!1,n["a"],s);e["default"]=c.exports},a538:function(t,e,a){},f535:function(t,e,a){"use strict";var n,r=function(){var t=this,e=t.$createElement,a=(t._self._c,t.__map(t.newsList,(function(e,a){var n=t.__map(t.dailyList,(function(e,a){var n=t._f("priceFormat")(e.BILL_LEFTMONEY,2,"￥",!0),r=t.__map(e.child,(function(e,a){var n=t._f("priceFormat")(e.BILLDETAIL_PRICE,2,"￥",!0),r=t._f("priceFormat")(e.BILLDETAIL_TOTALMONEY,2,"￥",!0);return{$orig:t.__get_orig(e),f1:n,f2:r}}));return{$orig:t.__get_orig(e),f0:n,l0:r}}));return{$orig:t.__get_orig(e),l1:n}}))),n=t._f("priceFormat")(t.sales,2,"￥",!0);t.$mp.data=Object.assign({},{$root:{l2:a,f3:n}})},i=[];a.d(e,"b",(function(){return r})),a.d(e,"c",(function(){return i})),a.d(e,"a",(function(){return n}))}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/uni-order/uniOrder-create-component',
    {
        'components/uni-order/uniOrder-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("a06c"))
        })
    },
    [['components/uni-order/uniOrder-create-component']]
]);
